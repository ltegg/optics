# optics
*A collection of .sh and .py scripts to handle files generated by the* OPTIC *programs within* WIEN2k.

Composed by Levi Tegg

## Description
[*WIEN2k*](http://susi.theochem.tuwien.ac.at/) is a collection of programs used to perform electronic structure calculations of solids, using density functional theory. Once a calculation has been completed, the *OPTIC* routine (consisting of programs `lapw2 -fermi`, `optic`, `joint`, and `kram`) will generate files containing optical properties data, such as the dielectric function (`*.epsilon`), or the optical conductivity (`*.absorp`).

This repository contains scripts which parse some of the files written by *WIEN2k* and *OPTIC*, then calculate optical constants such as complex refractive index, electron energy-loss spectra (EELS), and an approximation of the apparent colour.

## Requirements
This repository contains both Python (.py) and bash (.sh) scripts. In general, each script can be installed and used independently of the other scripts within this repository.

### Python
All of the scripts were written using Python 3.5. The libraries used are [numpy](http://www.numpy.org/), pyplot, part of [matplotlib](https://matplotlib.org/index.html), [glob](https://docs.python.org/3.5/library/glob.html), and [sys](https://docs.python.org/3.5/library/sys.html). These scripts were written using Spyder 3.1.x, using the Anaconda3 distribution.
    
### Bash
The bash scripts are largely handlers for the Python scripts. They should work with any bash-like terminal.

## Usage
Most of the python scripts include code to search the present working directory (pwd) for the files it needs. Alternatively, arguments can be passed to the script to tell it exactly what to process.

### `optic.py`
Calling

`$ python3 optic.py`

in a directory with one or more `*.epsilon` files will process all of the `*.epsilon` files in the pwd.

Alternatively, calling

`$ python3 optic.py case1.epsilon case2.epsilon case3.epsilon ...`

will make `optic.py` process only those epsilon files passed as arguments.

If 3 columns are found in a `*.epsilon` file, the script will assume a one-dimensional case. If 5 columns are found, the script will assume the x- and y-directions are equal, and the z-direction is different. If 7 columns are found, the script will assume the x-, y- and z-directions are different. Currently, there is no support for more than 3-directions.

The script will save images and data files with the same case name as the `*.epsilon` file, in the same directory as the `*.epsilon` file.

Further information can be found in the script comments.

## Issues
These scripts are designed for a very specific purpose, and so have not been designed with robustness or security in mind. As such, there are probably very many usage scenarios where these scripts produce incorrect results or fail completely. The author accepts no responsibility for results obtained using these scripts, and encourages users to read the scripts in their entirety before use. That said, there are some issues and bugs that I am aware of (and you should be too):

- Accurately interpolating wavelength and reflectivity for the calculation of the apparent colour relies on a fine energy spacing (in eV) across the visible energy range. The default values in `*.inop` are generally sufficient, but check your discretisation to ensure there are no sudden changes in the refractive index.
- When 2 or more dimensions are present some of the graphs generated by `optics.py` include optical constants for each direction (x, x,z or x,y,z), as well as a weighted sum (x+y+z). This is calculated via xyz = (x + y + z) / 3. Be aware that in the case of EELS data, the true loss spectrum for a polycrystalline sample of an anisotropic material cannot be calculated in this way.

## Feedback
I've uploaded the scripts onto GitHub so that they may be shared, repurposed and edited freely. That said, if you find an issue with the scripts that you'd like to discuss or have fixed, you are welcome to submit a pull request.

If you have questions about the physics and maths within the scripts, I would encourage you to leave a comment.
